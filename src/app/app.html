<div class="nba-container">
  <header class="header">
    <div class="header-content">
      <h1>{{ title() }}</h1>
      <p class="header-subtitle">Build Your Dream Team ğŸ†</p>
    </div>
  </header>

  @if (!showDraftMode()) {
    <div class="main-content">
      <!-- Team 1 -->
      <div class="team-section team-1">
        <div class="team-header">
          <div class="team-icon">ğŸ”´</div>
          <h2 class="team-name">{{ team1().name }}</h2>
        </div>
        <div class="captain-display" *ngIf="team1().captain">
          <span class="captain-badge">ğŸ‘‘ CAPTAIN</span>
          <span class="captain-name">{{ team1().captain }}</span>
        </div>
        
        <div class="players-grid">
          @for (player of team1().players; track $index) {
            <div class="player-card" [class.is-captain-card]="team1().captain === player.name">
              <div class="player-card-header">
                <div class="position-badge">{{ player.position }}</div>
                @if (player.name.trim() !== '') {
                  <div 
                    class="captain-icon"
                    [class.active]="team1().captain === player.name"
                    (click)="setCaptain(1, $index)"
                    title="{{ team1().captain === player.name ? 'Captain' : 'Set as Captain' }}"
                  >
                    ğŸ‘‘
                  </div>
                }
              </div>
              <input 
                type="text" 
                [(ngModel)]="player.name"
                [placeholder]="'Enter ' + player.position + ' name'"
                class="player-input"
              />
            </div>
          }
        </div>
      </div>

      <!-- VS Divider -->
      <div class="vs-section">
        <div class="vs-circle">VS</div>
        <div class="button-group">
          <button class="action-btn shuffle-btn" (click)="shuffleTeam(1)" title="Randomly shuffle all players between teams">
            <span class="btn-icon">ğŸ”€</span>
            <span class="btn-text">RESHUFFLE</span>
          </button>
          <button class="action-btn export-btn" (click)="exportTeamsToClipboard()" title="Copy teams to clipboard for Discord">
            <span class="btn-icon">ğŸ“‹</span>
            <span class="btn-text">EXPORT</span>
          </button>
          <button class="coin-toss-btn" (click)="coinToss()" title="Flip a coin to determine draft order">
            <span class="btn-icon">ğŸª™</span>
            <span class="btn-text">COIN TOSS</span>
          </button>
        </div>
        @if (coinTossResult()) {
          <div class="coin-result">
            <div class="coin-animation">{{ coinTossResult() }}</div>
            <div class="winner-text">{{ coinTossWinner() }} gets first pick!</div>
          </div>
        }
      </div>

      <!-- Team 2 -->
      <div class="team-section team-2">
        <div class="team-header">
          <div class="team-icon">ğŸ”µ</div>
          <h2 class="team-name">{{ team2().name }}</h2>
        </div>
        <div class="captain-display" *ngIf="team2().captain">
          <span class="captain-badge">ğŸ‘‘ CAPTAIN</span>
          <span class="captain-name">{{ team2().captain }}</span>
        </div>
        
        <div class="players-grid">
          @for (player of team2().players; track $index) {
            <div class="player-card" [class.is-captain-card]="team2().captain === player.name">
              <div class="player-card-header">
                <div class="position-badge">{{ player.position }}</div>
                @if (player.name.trim() !== '') {
                  <div 
                    class="captain-icon"
                    [class.active]="team2().captain === player.name"
                    (click)="setCaptain(2, $index)"
                    title="{{ team2().captain === player.name ? 'Captain' : 'Set as Captain' }}"
                  >
                    ğŸ‘‘
                  </div>
                }
              </div>
              <input 
                type="text" 
                [(ngModel)]="player.name"
                [placeholder]="'Enter ' + player.position + ' name'"
                class="player-input"
              />
            </div>
          }
        </div>
      </div>
    </div>
  } @else {
    <!-- Draft Mode -->
    <div class="draft-mode">
      <div class="draft-wrapper">
        <!-- Header -->
        <div class="draft-header-section">
          <div class="draft-title-bar">
            <h2 class="draft-title">ğŸ€ DRAFT MODE</h2>
            <button class="export-draft-btn" (click)="exportTeamsToClipboard()" title="Copy drafted teams to clipboard">
              <span class="btn-icon">ğŸ“‹</span>
              <span class="btn-text">EXPORT</span>
            </button>
            <button class="reset-btn" (click)="resetDraft()" title="Exit draft mode and return to team setup">
              <span class="btn-icon">ğŸ”™</span>
              <span class="btn-text">EXIT DRAFT</span>
            </button>
          </div>
        </div>

        <!-- Main Draft Area -->
        <div class="draft-main">
          <!-- Left: Team 1 -->
          <div class="draft-team-section team-1-draft-section">
            <div class="draft-team-header">
              <div class="team-icon">ğŸ”´</div>
              <h3>{{ team1().name }}</h3>
              <div class="player-count-badge">{{ draftedTeam1().length }}/5</div>
            </div>
            <div class="draft-team-roster">
              @for (player of draftedTeam1(); track player) {
                <div class="drafted-player-item">
                  <div class="player-position-box">{{ player.position }}</div>
                  <div class="player-name-text">{{ player.name }}</div>
                </div>
              }
              @if (draftedTeam1().length === 0) {
                <div class="empty-roster">Waiting for picks...</div>
              }
            </div>
          </div>

          <!-- Center: Pool & Current Drafter -->
          <div class="draft-center">
            <!-- Current Drafter -->
            <div class="current-drafter-card">
              <span class="drafter-label">Currently Picking:</span>
              <span class="drafter-team">{{ currentDrafter() }}</span>
            </div>

            <!-- Draft Pool -->
            <div class="draft-pool-section">
              <div class="pool-title-bar">
                <h3>Available Players</h3>
                <span class="pool-count">{{ draftPool().length }} left</span>
              </div>
              <div class="pool-grid">
                @for (player of draftPool(); track player) {
                  <button class="draft-player-card" (click)="draftPlayer(player)" [title]="'Draft ' + player.name + ' (' + player.position + ')'">
                    <div class="card-position">{{ player.position }}</div>
                    <div class="card-name">{{ player.name }}</div>
                    <div class="card-hover-text">TAP TO DRAFT</div>
                  </button>
                }
              </div>
            </div>
          </div>

          <!-- Right: Team 2 -->
          <div class="draft-team-section team-2-draft-section">
            <div class="draft-team-header">
              <div class="team-icon">ğŸ”µ</div>
              <h3>{{ team2().name }}</h3>
              <div class="player-count-badge">{{ draftedTeam2().length }}/5</div>
            </div>
            <div class="draft-team-roster">
              @for (player of draftedTeam2(); track player) {
                <div class="drafted-player-item">
                  <div class="player-position-box">{{ player.position }}</div>
                  <div class="player-name-text">{{ player.name }}</div>
                </div>
              }
              @if (draftedTeam2().length === 0) {
                <div class="empty-roster">Waiting for picks...</div>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  }
  
  <!-- Modal -->
  @if (showModal()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-container" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ modalTitle() }}</h2>
        </div>
        <div class="modal-body">
          <p>{{ modalMessage() }}</p>
        </div>
        <div class="modal-footer">
          @if (modalType() === 'confirm') {
            <button class="modal-btn modal-btn-secondary" (click)="closeModal()">
              Cancel
            </button>
            <button class="modal-btn modal-btn-primary" (click)="confirmModal()">
              Confirm
            </button>
          } @else {
            <button class="modal-btn modal-btn-primary" (click)="closeModal()">
              OK
            </button>
          }
        </div>
      </div>
    </div>
  }
</div>
